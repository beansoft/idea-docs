


<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Library / IntelliJ Platform SDK  DevGuide</title>
    <link rel="stylesheet" href="/app/app.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <link rel="mask-icon" href="/apple-mask-icon.svg" color="black">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-square70x70logo" content="/mstile-70x70.png">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/mstile-150x150.png">
    <meta name="msapplication-wide310x150logo" content="/mstile-310x150.png">
    <meta name="msapplication-square310x310logo" content="/mstile-310x310.png">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://kana112233.github.io//reference_guide/project_model/library.html" />
    <meta property="og:site_name" content="JetBrains IntelliJ Platform SDK" />
    <meta property="og:title" content="Library" />
    <meta property="og:description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta property="og:image" content="https://kana112233.github.io/jetbrains.png" />
    <meta property="article:modified_time" content="2019-05-09T23:57:17+08:00" />
    <!-- <meta property="article:section" content="" /> 
    <meta property="article:tag" content="" /> -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@JBPlatform" />
    <meta name="twitter:title" content="Library" />
    <meta name="twitter:description" content="Documentation for working with and extending the IntelliJ Platform SDK" />
    <meta name="twitter:image" content="https://kana112233.github.io/jetbrains.png" />
    <meta class="swiftype" name="product" data-type="string" content="/"></meta>
<link  rel="stylesheet" href="/app/styles.css"></head>
<body data-id="reference_guide/project_model/library">
<div class="wrapper">
    <section class="panel _nav">
        <header class="panel__header">
            <div class="container">
                <form class="search-box">
                    <label for="search-box__input" class="search-box__label">
                        <input type="text" class="search-box__input" id="search-box__input" placeholder="Search IntelliJ Platform SDK  DevGuide">
                    </label>
                    <div class="search-box__clear" title="Clear"></div>
                </form>
            </div>
        </header>
        <nav class="panel__content">
            <div class="container _nav">
                <menu class="nav-tree"></menu>
            </div>
            <div class="container _footer panel__footer">
                <p><a data-bypass="true" href="//youtrack.jetbrains.com/issues/IJSDK">Send feedback</a></p>
                <p>&copy; 2000&ndash;2019 <a href="//www.jetbrains.com">JetBrains</a> s.r.o.<br>
                    All rights reserved.</p>
            </div>
        </nav>
    </section>

    <main class="panel _main" role="main">
        <header class="panel__header">
            <div class="container">
                <h3>IntelliJ Platform SDK DevGuide</h3>
                
                <div class="panel-trigger"></div>
            </div>
        </header>
        <section class="panel__content">
            <div class="container">
                <article class="article" data-shortcut-switcher="false">
                    <div class="navigation-links _top" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/reference_guide/project_model/sdk.html">SDK</a>
                        <a class="navigation-links__next" href="/reference_guide/project_model/facet.html">Facet</a>
                    </div>
                    <a data-bypass="true" href="https://github.com/kana112233/kana112233.github.io/edit/master/reference_guide/project_model/library.md" class="page-link-to-github" target="_blank" title="Edit this page on GitHub">
                        <i class="github-icon"></i>
                        <span class="text">Edit page</span>
                    </a>

                    <h1>Library</h1>
                    <p>库是模块所依赖的已编译代码(例如JAR文件)的存档.</p>

<p>IntelliJ平台支持三种类型的库:</p>

<ul>
  <li>
    <p><strong>模块库</strong>:库类仅在此模块中可见,库信息记录在模块* .iml文件中.</p>
  </li>
  <li>
    <p><strong>项目库</strong>:库类在项目中可见,库信息记录在项目* .ipr文件或.idea/libraries中.</p>
  </li>
  <li>
    <p><strong>全局库</strong>:库信息在applicationLibraries.xml文件中记录到<code class="code highlight language-text">&lt;User Home&gt;/.IntelliJIdea/config/options</code>目录中.
全局库与项目库类似,但对于不同的项目是可见的.</p>
  </li>
</ul>

<p>有关库的更多信息,请参阅</p>

<p><a href="https://www.jetbrains.com/help/idea/working-with-libraries.html" data-bypass="yes" target="_blank"><span>Library</span></a>.</p>

<p>##访问库和罐子</p>

<p>包</p>

<p><a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-4f9b5f89b2a19ce700b1373a465c16b28ed8ad52/platform/projectModel-api/src/com/intellij/openapi/roots/libraries" data-bypass="yes" target="_blank"><span>libraries</span></a></p>

<p>提供使用项目库和jar的功能.</p>

<p>###如何获取模块所依赖的库列表？</p>

<p>要获取模块所依赖的库列表,请使用“OrderEnumerator.forEachLibrary”方法.</p>

<p>以下代码段演示了如何执行此操作:</p>

<div class="code-block" data-lang="java"><code class="code-block__wrapper"><span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">libraryNames</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="n">ModuleRootManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">module</span><span class="o">).</span><span class="na">orderEntries</span><span class="o">().</span><span class="na">forEachLibrary</span><span class="o">(</span><span class="n">library</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="n">libraryNames</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">library</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
  <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">});</span>
<span class="n">Messages</span><span class="o">.</span><span class="na">showInfoMessage</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">libraryNames</span><span class="o">,</span> <span class="s">"\n"</span><span class="o">),</span> <span class="s">"Libraries in Module"</span><span class="o">);</span>
</code></div>

<p>此示例代码输出<code class="code highlight language-text">module</code>模块所依赖的库列表.</p>

<p>###如何获取所有库的列表？</p>

<p>要管理应用程序和项目库的列表,<a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-4f9b5f89b2a19ce700b1373a465c16b28ed8ad52/platform/projectModel-api/src/com/intellij/openapi/roots/libraries/LibraryTable.java" data-bypass="yes" target="_blank"><span>LibraryTable</span></a></p>

<p>使用了类.
通过调用<code class="code highlight language-text">LibraryTablesRegistrar.getInstance().getLibraryTable()</code>来访问应用程序级库表的列表,</p>

<p>而项目级库表的列表可以通过<code class="code highlight language-text">LibraryTablesRegistrar.getInstance().getLibraryTable(Project)</code>来访问.</p>

<p>一旦你有一个<code class="code highlight language-text">LibraryTable</code>,你可以通过调用<code class="code highlight language-text">LibraryTable.getLibraries()</code>来获取它.</p>

<p>To get the list of all module libraries defined in a given module, use the following API:</p>
<div class="code-block" data-lang="java"><code class="code-block__wrapper"><span class="n">OrderEntryUtil</span><span class="o">.</span><span class="na">getModuleLibraries</span><span class="o">(</span><span class="n">ModuleRootManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">module</span><span class="o">));</span>
</code></div>

<p>###如何获取图书馆内容？</p>

<p><code class="code highlight language-text">Library</code>类提供了<code class="code highlight language-text">getUrls</code>方法,您可以使用它来获取库包含的源根和类的列表.
为了澄清,请考虑以下代码段:</p>

<div class="code-block" data-lang="java"><code class="code-block__wrapper"><span class="n">StringBuilder</span> <span class="n">roots</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">(</span><span class="s">"The "</span> <span class="o">+</span> <span class="n">lib</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" library includes:\n"</span><span class="o">);</span>
<span class="n">roots</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Sources:\n"</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">each</span> <span class="o">:</span> <span class="n">lib</span><span class="o">.</span><span class="na">getUrls</span><span class="o">(</span><span class="n">OrderRootType</span><span class="o">.</span><span class="na">SOURCES</span><span class="o">))</span> <span class="o">{</span>
  <span class="n">roots</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">each</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">roots</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Classes:\n"</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">each</span> <span class="o">:</span> <span class="n">lib</span><span class="o">.</span><span class="na">getUrls</span><span class="o">(</span><span class="n">OrderRootType</span><span class="o">.</span><span class="na">CLASSES</span><span class="o">))</span> <span class="o">{</span>
  <span class="n">strRoots</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">each</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
<span class="o">}</span>
<span class="n">Messages</span><span class="o">.</span><span class="na">showInfoMessage</span><span class="o">(</span><span class="n">roots</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="s">"Library Info"</span><span class="o">);</span>
</code></div>

<p>在此示例代码中,<code class="code highlight language-text">lib</code>是<a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-4f9b5f89b2a19ce700b1373a465c16b28ed8ad52/platform/projectModel-api/src/com/intellij/openapi/roots/libraries/Library.java" data-bypass="yes" target="_blank"><span>Library</span></a>类型.</p>

<p>###如何创建库？</p>

<p>要创建库,您需要执行以下步骤:</p>

<p>*获取<a href="../../basics/architectural_overview/general_threading_rules.html#readwrite-lock"><span>写入操作</span></a>
  
*获取要添加库的库表.
根据库级别,使用以下其中一项:
      
*<code class="code highlight language-text">LibraryTablesRegistrar.getInstance().getLibraryTable()</code>
      
*<code class="code highlight language-text">LibraryTablesRegistrar.getInstance().getLibraryTable(Project)</code>
      
*<code class="code highlight language-text">ModuleRootManager.getInstance(module).getModifiableModel().getModuleLibraryTable()</code>
  
*通过调用<code class="code highlight language-text">LibraryTable.createLibrary()</code>创建库
  
*将内容添加到库中(见下文)
  
*对于模块级库,提交由<code class="code highlight language-text">ModuleRootManager.getInstance(module).getModifiableModel()</code>返回的可修改模型.
  </p>

<p>对于模块级库,您还可以在[ModuleRootModificationUtil]中使用简化的API(upsource:///platform/projectModel-api/src/com/intellij/openapi/roots/ModuleRootModificationUtil.java)</p>

<p>用于添加具有单个API调用的库的类.
您可以在[示例插件]中找到使用这些API的示例(https://github.com/JetBrains/intellij-sdk-docs/blob/master/code_samples/project_model/src/com/intellij/tutorials/project/
模型/ModificationAction.java).</p>

<p>###如何将内容添加到库或修改它？</p>

<p>要添加或更改库的根,您需要执行以下步骤:</p>

<p>*获取<a href="../../basics/architectural_overview/general_threading_rules.html#readwrite-lock"><span>写入操作</span></a>
  
*使用<code class="code highlight language-text">Library.getModifiableModel()</code>获取库的<strong>可修改模型</strong>
  
*使用诸如<code class="code highlight language-text">Library.ModifiableModel.addRoot()</code>之类的方法来执行必要的更改
  
*使用<code class="code highlight language-text">Library.ModifiableModel.commit()</code>提交模型.
  </p>

<p>###如何向模块添加库依赖项？</p>

<p>在写入操作下使用<code class="code highlight language-text">ModuleRootModificationUtil.addDependency(module,library)</code>.</p>

<p>###检查属于图书馆</p>

<p><a href="https://upsource.jetbrains.com/idea-ce/file/idea-ce-4f9b5f89b2a19ce700b1373a465c16b28ed8ad52/platform/projectModel-api/src/com/intellij/openapi/roots/ProjectFileIndex.java" data-bypass="yes" target="_blank"><span>ProjectFileIndex</span></a>接口实现了许多方法,可用于检查指定的文件是否属于项目库
课程或图书馆资源.</p>

<p>您可以使用以下方法:</p>

<p>*检查指定的虚拟文件是否是编译的类文件使用</p>

<div class="code-block" data-lang="java"><code class="code-block__wrapper"><span class="n">ProjectFileIndex</span><span class="o">.</span><span class="na">isLibraryClassFile</span><span class="o">(</span><span class="n">virtualFile</span><span class="o">)</span>
</code></div>
<ul>
  <li>
    <p>To check if a specified virtual file or directory belongs to library classes use</p>

<div class="code-block" data-lang="java"><code class="code-block__wrapper"><span class="n">ProjectFileIndex</span><span class="o">.</span><span class="na">isInLibraryClasses</span><span class="o">(</span><span class="n">virtualFileorDirectory</span><span class="o">)</span>
</code></div>
  </li>
  <li>
    <p>To check if the specified virtual file or directory belongs to library sources use</p>

<div class="code-block" data-lang="java"><code class="code-block__wrapper"><span class="n">ProjectFileIndex</span><span class="o">.</span><span class="na">isInLibrarySource</span><span class="o">(</span><span class="n">virtualFileorDirectory</span><span class="o">)</span>
</code></div>
  </li>
</ul>

<p>请参阅以下<a href="https://github.com/JetBrains/intellij-sdk-docs/blob/master/code_samples/project_model/src/com/intellij/tutorials/project/model/ProjectFileIndexSampleAction.java" data-bypass="yes" target="_blank"><span>代码示例</span></a></p>

<p>看看如何应用上述方法.</p>

<p>有关库的更多详细信息,请参阅此处</p>

<p><a href="https://github.com/JetBrains/intellij-sdk-docs/blob/master/code_samples/project_model/src/com/intellij/tutorials/project/model/LibrariesAction.java" data-bypass="yes" target="_blank"><span>代码示例</span></a></p>



                    <div class="navigation-links _bottom" data-swiftype-index="false">
                        <a class="navigation-links__prev" href="/reference_guide/project_model/sdk.html">SDK</a>
                        <a class="navigation-links__next" href="/reference_guide/project_model/facet.html">Facet</a>
                    </div>
                    <div class="last-modified">
                        Last modified: 9 May 2019
                    </div>
                </article>

                <section class="disqus">
                    <div id="disqus_thread"></div>
                </section>
            </div>
        </section>
    </main>
</div>

<script src="/app/app.js" data-baseurl="/"></script>

</body>
</html>

